## 브라우저 모듈

```jsx
<script type="module">
```

- 스크립트가 모듈이라는 것을 명시해야한다.
- 엄격 모드
- 모듈 레벨 스코프가 존재한다.
- 단 한번만 평가됨
    - 같은 모듈이 여러 곳에서 사용되어도 최초 호출 시 단 한번만 실행된다.
- `import.meta` 로 모듈에 대한 정보를 알 수 있다.
- this는 undefined
    - 모듈 최상위 레벨의 this는 undefined
    - 일반 스크립트의 경우는 this는 전역 객체

### 지연 실행

- 항상 지연 실행
- `defer` 속성을 붙인 것 처럼 실행된다.
- 모듈이 완전히 로드되기 전 사용자에게 페이지가 노출되면 혼란을 느낄 수 있다.
    - 모듈 스크립트를 불러오는 동안 투명 오버레이나 로딩 indicator 를 보여준다

### 인라인 스크립트의 비동기 처리

- defer 와 같이 HTML 처리와 병렬적으로 스크립트가 로딩 된다.
- 스크립트 로딩이 끝나면, HTML 문서나 다른 스크립트가 로드되길 기다리지 않고 바로 실행된다.
- 광고, 문서 레벨 이벤트 리스너, 카운터 등 `어디에도 종속되지 않는 기능`을 구현할 때 유용하다.
- 모듈 스크립트의 async 속성
    - 인라인으로 async 속성을 적용할 수 있다.

### 외부 스크립트

- 'src' 속성 값이 동일한 외부 스크립트는 한 번만 실행된다.
- Cross Origin 요청에서 CORS 헤더가 필요하다.
    - 모듈이 저장되어있는 원격 서버에서 `Access-Control-Allow-Origin: *`
     헤더를 제공해줘야 한다.
    

### 경로가 없는 모듈은 금지

- 브라우저 환경에서 import 는 반드시 상대/절대 URL 앞에 와야 한다.

### 호환을 위한 ‘nomodule’

- 구식 브라우저
    - `type="module"` 을 해석하지 못하여, 무시하고 넘어간다.
- 모던 브라우저
    - `type="module"` 을 해석한다.

```jsx
<script type="module">
  alert("모던 브라우저를 사용하고 계시군요.");
</script>

<script nomodule>
  alert("type=module 을 해석할 수 있는 브라우저는 nomodule 타입의 스크립트는 넘어갑니다. 따라서 이 alert 문은 실행되지 않습니다.")
  alert("오래된 브라우저를 사용하고 있다면, type=module 이 붙은 스크립트는 무시합니다. 대신 이 alert 문이 실행됩니다.");
</script>
```